---
title: '垃圾回收机制'
date: 2015-08-14
permalink: /posts/2012/08/blog-post-4/
tags:
  - cool posts
  - category1
  - category2
---

## 垃圾回收机制

使用可达性分析算法探索所有存活对象。GC Roots
可达性分析：把所有存活对象放到集合中，从该集合出发，探索被该集合的引用的对象，并加入到该集合中，未被探索到的对象便是死亡对象。

为了防止在标记过程中堆栈的状态发生改变，Java虚拟机采取安全点机制实现Stop-the-world，暂停其他非垃圾回收线程
当虚拟机收到stop-the-world请求时，会等待所有线程到达安全点，才允许stop-the-world的线程执行。

### 垃圾回收的三种方式
**清除**
把死亡对象占据的内存标记为空闲内存，并记录一个空闲列表，当需要新建对象时，从空闲列表划分给新建对象。
缺点：1.会造成内存碎片。堆中对象内存必须是连续的
     2.分配效率低。需要逐个判断空闲列表中内存大小是否能够放入新建对象
     
---

**压缩**
把存活对象聚集到内存起始位置
缺点：压缩算法的性能开销

---

**复制**
把内存区域分为两等分，由from、to两个指针，只能由from指针指向的内存区域来分配内存。当发生垃圾回收时，把存活对象放到to区域，并且交换from、to指针的内容。缺点：堆空间的使用效率低下
